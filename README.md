# MEV Dashboard - MEVäº¤æ˜“ç›‘æ§ç³»ç»Ÿ

ä¸€ä¸ªåŸºäºReact + TypeScript + Fastifyçš„MEVäº¤æ˜“ç›‘æ§ä¸åˆ†æç³»ç»Ÿï¼Œæä¾›å®æ—¶äº¤æ˜“ç›‘æ§ã€æ”¶ç›Šåˆ†æã€é¢„è­¦ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## ğŸ“ é¡¹ç›®æ¶æ„

```
jojo/
â”œâ”€â”€ src/                          # å‰ç«¯æºä»£ç 
â”‚   â”œâ”€â”€ components/               # Reactç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ Dashboard.tsx         # ä¸»ä»ªè¡¨æ¿
â”‚   â”‚   â”œâ”€â”€ LoginPage.tsx         # ç™»å½•é¡µé¢
â”‚   â”‚   â”œâ”€â”€ WelcomePage.tsx       # æ¬¢è¿é¡µé¢
â”‚   â”‚   â”œâ”€â”€ ChainManager.tsx      # é“¾ç®¡ç†ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ NodeStatusModal.tsx   # èŠ‚ç‚¹çŠ¶æ€å¼¹çª—
â”‚   â”‚   â””â”€â”€ TradingComponents/    # äº¤æ˜“ç›¸å…³ç»„ä»¶
â”‚   â”œâ”€â”€ services/                 # APIæœåŠ¡
â”‚   â”œâ”€â”€ hooks/                    # è‡ªå®šä¹‰Hook
â”‚   â”œâ”€â”€ types/                    # ç±»å‹å®šä¹‰
â”‚   â””â”€â”€ App.tsx                   # ä¸»åº”ç”¨
â”œâ”€â”€ server/                       # åç«¯æºä»£ç 
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ index.ts             # æœåŠ¡å™¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ entities/            # æ•°æ®åº“å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ TradeInfo.ts     # äº¤æ˜“ä¿¡æ¯å®ä½“
â”‚   â”‚   â”‚   â”œâ”€â”€ ChainConfig.ts   # é“¾é…ç½®å®ä½“
â”‚   â”‚   â”‚   â””â”€â”€ User.ts          # ç”¨æˆ·å®ä½“
â”‚   â”‚   â”œâ”€â”€ routes/              # è·¯ç”±å®šä¹‰
â”‚   â”‚   â”‚   â”œâ”€â”€ trade.routes.ts  # äº¤æ˜“è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.routes.ts   # è®¤è¯è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ chain.routes.ts  # é“¾ç®¡ç†è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ warning.routes.ts # é¢„è­¦è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ profit.routes.ts # æ”¶ç›Šè·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ token.routes.ts  # ä»£å¸è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ tag.routes.ts    # æ ‡ç­¾è·¯ç”±
â”‚   â”‚   â”‚   â””â”€â”€ node.routes.ts   # èŠ‚ç‚¹è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ services/            # ä¸šåŠ¡é€»è¾‘æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ cache.service.ts # ç¼“å­˜æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ scheduler.service.ts # è°ƒåº¦æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket.service.ts # WebSocketæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ trade.service.ts # äº¤æ˜“æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ auth.service.ts  # è®¤è¯æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ profit.service.ts # æ”¶ç›ŠæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ token-profit.service.ts # ä»£å¸æ”¶ç›ŠæœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ warning.service.ts # é¢„è­¦æœåŠ¡
â”‚   â”‚   â”‚   â”œâ”€â”€ tag.service.ts   # æ ‡ç­¾æœåŠ¡
â”‚   â”‚   â”‚   â””â”€â”€ node.service.ts  # èŠ‚ç‚¹æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ config/              # é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ types/               # ç±»å‹å®šä¹‰
â”‚   â”‚   â””â”€â”€ utils/               # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ scripts/                 # ç®¡ç†è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ user-manager.ts      # ç”¨æˆ·ç®¡ç†è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ trade-manager.ts     # äº¤æ˜“ç®¡ç†è„šæœ¬
â”‚   â”‚   â””â”€â”€ migrate-database.ts  # æ•°æ®åº“è¿ç§»è„šæœ¬
â”‚   â”œâ”€â”€ data/                    # æ•°æ®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ chains.json          # é“¾é…ç½®
â”‚   â”‚   â””â”€â”€ database.sqlite      # SQLiteæ•°æ®åº“
â”‚   â””â”€â”€ dist/                    # ç¼–è¯‘è¾“å‡º
â””â”€â”€ package.json                 # é¡¹ç›®é…ç½®
```

## ğŸš€ åŠŸèƒ½è¯´æ˜

### ğŸ” ç”¨æˆ·è®¤è¯
- åŸºäºJWTçš„ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- æ”¯æŒadminå’Œæ™®é€šç”¨æˆ·ä¸¤ç§è§’è‰²
- å¯†ç åŠ å¯†å­˜å‚¨

### ğŸ“Š äº¤æ˜“ç›‘æ§
- **å®æ—¶äº¤æ˜“ç›‘æ§**ï¼šWebSocketå®æ—¶æ¨é€äº¤æ˜“æ•°æ®
- **äº¤æ˜“æœç´¢**ï¼šæ”¯æŒå¤šæ¡ä»¶æœç´¢å†å²äº¤æ˜“
- **äº¤æ˜“è¯¦æƒ…**ï¼šæŸ¥çœ‹å®Œæ•´äº¤æ˜“ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¥—åˆ©è·¯å¾„ã€ä»£å¸ä¿¡æ¯ç­‰
- **å¤šé“¾æ”¯æŒ**ï¼šæ”¯æŒå¤šä¸ªåŒºå—é“¾ç½‘ç»œçš„äº¤æ˜“ç›‘æ§

### ğŸ’° æ”¶ç›Šåˆ†æ
- **å®æ—¶æ”¶ç›Šç»Ÿè®¡**ï¼šæŒ‰é“¾ç»Ÿè®¡æ¯æ—¥æ”¶ç›Š
- **æ ‡ç­¾æ”¶ç›Šåˆ†æ**ï¼šæŒ‰äº¤æ˜“æ ‡ç­¾åˆ†ææ”¶ç›Šåˆ†å¸ƒ
- **ä»£å¸æ”¶ç›Šè·Ÿè¸ª**ï¼šè¿½è¸ªå„ä»£å¸çš„æ”¶ç›Šæƒ…å†µ
- **æ”¶ç›Šå›¾è¡¨**ï¼šå¯è§†åŒ–æ”¶ç›Šè¶‹åŠ¿

### âš ï¸ é¢„è­¦ç³»ç»Ÿ
- **å®æ—¶é¢„è­¦**ï¼šç›‘æ§å¼‚å¸¸äº¤æ˜“å’Œç³»ç»ŸçŠ¶æ€
- **é¢„è­¦ç®¡ç†**ï¼šæ”¯æŒæŸ¥çœ‹ã€åˆ é™¤ã€æ‰¹é‡ç®¡ç†é¢„è­¦
- **åˆ†ç±»é¢„è­¦**ï¼šæŒ‰ç±»å‹å’Œé“¾è¿›è¡Œé¢„è­¦åˆ†ç±»

### ğŸ”§ ç³»ç»Ÿç®¡ç†
- **é“¾ç®¡ç†**ï¼šåŠ¨æ€é…ç½®æ”¯æŒçš„åŒºå—é“¾ç½‘ç»œ
- **èŠ‚ç‚¹ç›‘æ§**ï¼šå®æ—¶ç›‘æ§å„é“¾èŠ‚ç‚¹çŠ¶æ€
- **æ€§èƒ½ç›‘æ§**ï¼šCPUã€å†…å­˜ã€ç½‘ç»œçŠ¶æ€ç›‘æ§
- **æ•°æ®æ¸…ç†**ï¼šè‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®

### ğŸ“± ç§»åŠ¨ç«¯é€‚é…
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯è®¿é—®
- ç§»åŠ¨ç«¯ä¸“ç”¨äº¤æ˜“å¡ç‰‡å¸ƒå±€
- è§¦æ‘¸å‹å¥½çš„äº¤äº’è®¾è®¡

## ğŸ› ï¸ éƒ¨ç½²è¯´æ˜

### ç¯å¢ƒè¦æ±‚
- Node.js 18+
- SQLite3
- PM2 (å¯é€‰ï¼Œç”¨äºç”Ÿäº§ç¯å¢ƒ)

### å¿«é€Ÿéƒ¨ç½²

1. **å…‹éš†é¡¹ç›®**
```bash
git clone <repository-url>
cd mev_dashboard
```

2. **å®‰è£…ä¾èµ–**
```bash
# å‰ç«¯ä¾èµ–
npm install

# åç«¯ä¾èµ–
cd server
npm install
```

3. **é…ç½®ç¯å¢ƒå˜é‡**
```bash
# å‰ç«¯é…ç½® (.env.local)
VITE_API_BASE_URL=http://localhost:3000

# åç«¯é…ç½® (server/.env)
NODE_ENV=production
PORT=3000
JWT_SECRET=your-secret-key
```

4. **åˆå§‹åŒ–æ•°æ®åº“**
```bash
cd server
npm run user:init
npm run user:create
```

5. **æ„å»ºé¡¹ç›®**
```bash
# æ„å»ºå‰ç«¯
npm run build

# æ„å»ºåç«¯
cd server
npm run build
```

6. **å¯åŠ¨æœåŠ¡**
```bash
# å¯åŠ¨åç«¯
cd server
npm start

# å‰ç«¯å·²æ„å»ºåˆ°distç›®å½•ï¼Œé…ç½®WebæœåŠ¡å™¨æ‰˜ç®¡
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

#### ä½¿ç”¨PM2éƒ¨ç½²
```bash
cd server
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

#### Nginxé…ç½®ç¤ºä¾‹
```nginx
server {
    listen 80;
    server_name your-domain.com;

    # å‰ç«¯é™æ€æ–‡ä»¶
    location / {
        root /path/to/jojo/dist;
        try_files $uri $uri/ /index.html;
    }

    # APIä»£ç†
    location /api/ {
        proxy_pass http://localhost:3000/api/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # WebSocketä»£ç†
    location /socket.io/ {
        proxy_pass http://localhost:3000/socket.io/;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

## ğŸ“¡ åç«¯POST APIè¯´æ˜

### è®¤è¯ç›¸å…³

#### ç”¨æˆ·ç™»å½•
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "string",
  "password": "string"
}
```

### äº¤æ˜“æ•°æ®æ¨é€

#### åˆ›å»ºäº¤æ˜“è®°å½•
```http
POST /api/trade
Authorization: Bearer <token>
Content-Type: application/json

{
  "chain": "string",           // é“¾åç§° (å¿…å¡«)
  "builder": "string",         // æ„å»ºè€… (å¿…å¡«)
  "hash": "string",            // äº¤æ˜“å“ˆå¸Œ (å¿…å¡«)
  "vicHashes": ["string"],     // å—å®³è€…äº¤æ˜“å“ˆå¸Œ (å¯é€‰)
  "gross": 0.0,                // æ€»æ”¶ç›Š (å¯é€‰)
  "bribe": 0.0,                // è´¿èµ‚é‡‘é¢ (å¯é€‰)
  "income": 0.0,               // å‡€æ”¶ç›Š (å¯é€‰)
  "txCount": 0,                // äº¤æ˜“æ•°é‡ (å¯é€‰)
  "ratio": 0.0,                // æ”¶ç›Šç‡ (å¯é€‰)
  "extraInfo": "string",       // é¢å¤–ä¿¡æ¯ (å¯é€‰)
  "tags": ["string"],          // æ ‡ç­¾åˆ—è¡¨ (å¯é€‰)
  "incTokens": [{              // æ”¶ç›Šä»£å¸åˆ—è¡¨ (å¯é€‰)
    "addr": "string",          // ä»£å¸åœ°å€ (addræˆ–addressäºŒé€‰ä¸€)
    "address": "string",       // ä»£å¸åœ°å€ (addræˆ–addressäºŒé€‰ä¸€)  
    "symbol": "string"         // ä»£å¸ç¬¦å· (å¿…å¡«)
  }]
}
```

#### åˆ›å»ºé¢„è­¦
```http
POST /api/warning
Authorization: Bearer <token>
Content-Type: application/json

{
  "chain": "string",           // é“¾åç§° (å¿…å¡«)
  "type": "string",            // é¢„è­¦ç±»å‹ (å¿…å¡«)
  "msg": "string"              // é¢„è­¦æ¶ˆæ¯ (å¿…å¡«)
}
```

### èŠ‚ç‚¹çŠ¶æ€ä¸ŠæŠ¥

#### ä¸ŠæŠ¥èŠ‚ç‚¹çŠ¶æ€
```http
POST /api/node/status
Authorization: Bearer <token>
Content-Type: application/json

{
  "chain": "string",           // é“¾åç§° (å¿…å¡«)
  "online": true,              // åœ¨çº¿çŠ¶æ€ (å¿…å¡«)
  "cpuUsage": 0.0
  "memoryUsage": 0.0,
  "blockTime": 0.0   // è¿™é‡ŒæŒ‡çš„æ˜¯ blockDiffTime
}
```

### é“¾é…ç½®ç®¡ç†

#### æ·»åŠ é“¾é…ç½®
```http
POST /api/chain/config
Authorization: Bearer <token>
Content-Type: application/json

{
  "id": "string",              // é“¾ID (å¿…å¡«)
  "name": "string",            // é“¾åç§° (å¿…å¡«)
  "displayName": "string",     // æ˜¾ç¤ºåç§° (å¿…å¡«)
  "symbol": "string",          // ä»£å¸ç¬¦å· (å¿…å¡«)
  "color": "#000000",          // ä¸»é¢˜è‰² (å¿…å¡«)
  "explorerUrl": {             // åŒºå—æµè§ˆå™¨URL (å¿…å¡«)
    "tx": "string",
    "address": "string"
  },
  "enabled": true,             // æ˜¯å¦å¯ç”¨ (å¯é€‰)
  "order": 0                   // æ˜¾ç¤ºé¡ºåº (å¯é€‰)
}
```

### å“åº”æ ¼å¼

#### æˆåŠŸå“åº”
```json
{
  "success": true,
  "data": {},
  "message": "æ“ä½œæˆåŠŸ"
}
```

#### é”™è¯¯å“åº”
```json
{
  "success": false,
  "error": "é”™è¯¯ä¿¡æ¯",
  "code": 400
}
```

### è®¤è¯æ–¹å¼

æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«JWT Tokenï¼š
```http
Authorization: Bearer <your-jwt-token>
```

### é™æµè¯´æ˜

- ç™»å½•æ¥å£ï¼šæ¯åˆ†é’Ÿæœ€å¤š10æ¬¡è¯·æ±‚
- äº¤æ˜“æ¨é€ï¼šæ¯åˆ†é’Ÿæœ€å¤š2000æ¬¡è¯·æ±‚
- æŸ¥è¯¢æ¥å£ï¼šæ¯åˆ†é’Ÿæœ€å¤š1000æ¬¡è¯·æ±‚
- å…¶ä»–æ¥å£ï¼šæ¯åˆ†é’Ÿæœ€å¤š100æ¬¡è¯·æ±‚

## ğŸ”§ ç®¡ç†è„šæœ¬

### ç”¨æˆ·ç®¡ç†
```bash
# åˆå§‹åŒ–ç”¨æˆ·è¡¨
npm run user:init

# åˆ›å»ºç”¨æˆ·
npm run user:create

# åˆ—å‡ºç”¨æˆ·
npm run user:list

# åˆ é™¤ç”¨æˆ·
npm run user:delete

# å¯ç”¨/ç¦ç”¨ç”¨æˆ·
npm run user:enable
npm run user:disable
```

### äº¤æ˜“ç®¡ç†
```bash
# äº¤æ˜“æ•°æ®ç®¡ç†
npx tsx server/scripts/trade-manager.ts [command] [options]

# ç¤ºä¾‹ï¼šæŸ¥è¯¢äº¤æ˜“
npx tsx server/scripts/trade-manager.ts query --chain ethereum --limit 10

# ç¤ºä¾‹ï¼šåˆ é™¤äº¤æ˜“
npx tsx server/scripts/trade-manager.ts delete --id 123 --dry-run
```

### æ•°æ®åº“ç®¡ç†
```bash
# æ•°æ®åº“è¿ç§»
npm run migrate:analyze
npm run migrate:run
npm run migrate:report
```

## âš ï¸ å…è´£å£°æ˜

### ä½¿ç”¨å£°æ˜
æœ¬è½¯ä»¶å…¨ç”±AIç”Ÿæˆ
æœ¬è½¯ä»¶ä»…ä¾›å­¦ä¹ å’Œç ”ç©¶ç›®çš„ä½¿ç”¨ï¼Œä¸å¾—ç”¨äºä»»ä½•å•†ä¸šç”¨é€”æˆ–è¿æ³•æ´»åŠ¨ã€‚

### é£é™©æç¤º
1. **æŠ•èµ„é£é™©**ï¼šMEVäº¤æ˜“æ¶‰åŠå¤æ‚çš„åŒºå—é“¾æŠ€æœ¯å’Œå¸‚åœºé£é™©ï¼Œç”¨æˆ·åº”å……åˆ†äº†è§£ç›¸å…³é£é™©ã€‚
2. **æŠ€æœ¯é£é™©**ï¼šæœ¬ç³»ç»Ÿå¯èƒ½å­˜åœ¨æŠ€æœ¯ç¼ºé™·æˆ–å®‰å…¨æ¼æ´ï¼Œä½¿ç”¨å‰è¯·å……åˆ†æµ‹è¯•ã€‚
3. **æ•°æ®å‡†ç¡®æ€§**ï¼šç³»ç»Ÿæä¾›çš„æ•°æ®ä»…ä¾›å‚è€ƒï¼Œä¸ä¿è¯æ•°æ®çš„å‡†ç¡®æ€§å’Œå®Œæ•´æ€§ã€‚

### è´£ä»»é™åˆ¶
1. æœ¬è½¯ä»¶æŒ‰"ç°çŠ¶"æä¾›ï¼Œä¸æä¾›ä»»ä½•å½¢å¼çš„æ‹…ä¿ã€‚
2. ä½œè€…ä¸æ‰¿æ‹…å› ä½¿ç”¨æœ¬è½¯ä»¶è€Œäº§ç”Ÿçš„ä»»ä½•ç›´æ¥æˆ–é—´æ¥æŸå¤±ã€‚
3. ç”¨æˆ·åº”è‡ªè¡Œæ‰¿æ‹…ä½¿ç”¨æœ¬è½¯ä»¶çš„é£é™©å’Œè´£ä»»ã€‚

### æ³•å¾‹åˆè§„
1. ç”¨æˆ·åº”éµå®ˆæ‰€åœ¨åœ°åŒºçš„æ³•å¾‹æ³•è§„ã€‚
2. ç¦æ­¢å°†æœ¬è½¯ä»¶ç”¨äºä»»ä½•è¿æ³•æˆ–ä¸å½“æ´»åŠ¨ã€‚
3. å¦‚å‘ç°è¿æ³•ä½¿ç”¨ï¼Œä½œè€…ä¿ç•™è¿½ç©¶æ³•å¾‹è´£ä»»çš„æƒåˆ©ã€‚

### ç‰ˆæƒè¯´æ˜
æœ¬é¡¹ç›®é‡‡ç”¨MITè®¸å¯è¯ï¼Œå…è®¸åœ¨éµå¾ªè®¸å¯è¯æ¡æ¬¾çš„å‰æä¸‹è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹å’Œåˆ†å‘ã€‚

---

**æ³¨æ„**ï¼šä½¿ç”¨æœ¬è½¯ä»¶å³è¡¨ç¤ºæ‚¨å·²é˜…è¯»å¹¶åŒæ„ä¸Šè¿°å…è´£å£°æ˜ã€‚å¦‚ä¸åŒæ„ï¼Œè¯·å‹¿ä½¿ç”¨æœ¬è½¯ä»¶ã€‚

*æœ€åæ›´æ–°ï¼š2024å¹´*
